# Automated-Variant-Calling-Pipeline-using-Fastq-Input-and-Docker

## Overview

This pipeline processes paired-end Fastq files (***_R1.fastq.gz and ***_R2.fastq.gz) to generate BAM, VCF, and index files. It uses Fastp, BWA, and GATK v4, and runs entirely in a Docker environment. The workflow is fully automated, ensuring seamless file generation from input to output.

This pipeline is designed to process paired-end Fastq files to generate recalibrated BAM files and VCF files using GATK. The entire process is automated and runs within a Docker container.

## Docker Image

Before running the pipeline, you need to pull the Docker image with all necessary tools and reference files:

```bash
docker pull cosmos9526/varient_calling:latest
```

## Input Requirements

You need to provide two Fastq files for input:

- Forward reads: `***_R1.fastq.gz`
- Reverse reads: `***_R2.fastq.gz`

Ensure that the files are named in a systematic manner, with `_R1` and `_R2` indicating forward and reverse reads, respectively.

## Where to Place Files

1. **Input Files:** Place your paired Fastq files inside the `input` folder that should be in the same directory as the script (`run.py`). If the folder doesn't exist, it will be created automatically.
   
   - Example structure:
     ```
     /your_project_directory/
     ├── input/
     │   ├── sample_R1.fastq.gz
     │   └── sample_R2.fastq.gz
     ├── output/
     ├── run.py
     ```

2. **Script Location:** Ensure the `run.py` script is placed in the same directory where the `input` and `output` folders will be created.

## Running the Script

To execute the pipeline, run the Python script (`run.py`). The script will handle running the Docker container, which will process the Fastq files and produce the desired output.

```bash
python3 run.py
```

## Output

The pipeline will generate the following output in the `output` folder:

- **Recalibrated BAM file**: Contains the processed and realigned sequence reads.
- **VCF file**: A Variant Call Format file generated by GATK, containing the variant calls.
- **Index files**: BAM and VCF index files for fast access.

## References

All necessary reference files (e.g., reference genome) are already included in the Docker container. You do not need to provide any additional reference data.

## Log

During execution, logs will be generated and saved to `docker_output.log` in the project directory, detailing the Docker container's progress and any errors encountered.

## contact info
Milad Bagheri 
milad9dxb@gmail.com

